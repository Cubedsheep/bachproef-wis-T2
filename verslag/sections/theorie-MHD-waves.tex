\subsection{Magnetohydrodynamic waves}


For our discussion of magnetohydrodynamic we rewrite the basic MHD equations into a form which is easier to linearalize. We also assume that the plasma is completely homogeneous and in equilibrium. In practice this means that we shall remove the cross products in the original equations as follows 

{\centering 
\noindent{
\begin{equation}
	\begin{split}
		- \vec{J} \times \vec{B} &= -(\nabla  \times \vec{B}) \times \vec{B} = (\nabla \vec{B}) \cdot \vec{B} - \vec{B} \cdot \nabla \vec{B}\\
		\nabla \times \vec{E} &= -\nabla \times (\vec{v} \times \vec{B}) =  \vec{B} \nabla \cdot \vec{v} + \vec{v} \cdot \nabla \vec{B} - \vec{B} \cdot \nabla \vec{v}
	\end{split}
\end{equation}
}
\par}


The MHD equations now become

{\centering 
\noindent \fbox{\parbox{.85\linewidth}{
\begin{equation}
	\label{eq:ideal-MHD-withoutcross}
	\begin{split}
		\frac{\partial\rho}{\partial t} + \nabla\cdot (\rho\vec{v}) &= 0\\
		\rho \frac{\partial \vec{v}}{\partial t} + \rho \vec{v} \cdot \nabla \vec{v} + (\gamma - 1)\nabla (\rho e) + (\nabla \vec{B})\cdot \vec{B} - \vec{B} \cdot \nabla \vec{B} &= 0\\
		\frac{\partial e}{\partial t} + \vec{v} \cdot \nabla e + (\gamma -1)e \nabla \cdot \vec{v} &= 0\\
		\frac{\partial \vec{B}}{\partial t} + \vec{v} \cdot \nabla \vec{B} + \vec{B} \nabla \cdot \vec{v} - \vec{B} \cdot \nabla \vec{v} &= 0
	\end{split}
\end{equation}
}}
\par}

Of course the condition that $ \nabla \cdot \vec{B} = 0  $ remains. In this form the equations are much easier to linearalize:

{\centering 
\noindent \fbox{\parbox{.85\linewidth}{
\begin{equation}
	\label{eq:ideal-MHD-linear}
	\begin{split}
		\frac{\partial\rho_1}{\partial t} + \nabla\cdot (\rho_0\vec{v}_1) &= 0\\
		\rho_0 \frac{\partial \vec{v}_1}{\partial t} + (\gamma - 1)\nabla (\rho_1 e_0) +\nabla (\rho_0 e_1) + (\nabla \vec{B}_1)\cdot \vec{B}_0 - \vec{B}_0 \cdot \nabla \vec{B}_1 &= 0\\
		\frac{\partial e_1}{\partial t} + (\gamma -1)e_0 \nabla \cdot \vec{v}_1 &= 0\\
		\frac{\partial \vec{B}_1}{\partial t} + \vec{B}_0 \nabla \cdot \vec{v}_1 - \vec{B}_0 \cdot \nabla \vec{v}_1 &= 0
	\end{split}
\end{equation}
}}
\par}

The second one of these equations \autoref{eq:ideal-MHD-linear} is the linearalized momentum equation. We shall work from this one as it lends itself the most for our discussion of ideal MHD waves. This is because it directly describes flow velocity. Plugging the other three into this equation gives us the essential equation for ideal MHD waves:

\begin{equation}
	\label{eq:ideal-wave}		
		\frac{\partial^2 \vec{v}_1}{\partial^2 t} = \bigg( (\vec{b} \nabla)^2 \I + (b^2 + c^2)\nabla \nabla - \vec{b} \cdot \nabla (\nabla \vec{b} + \vec{b} \nabla) \bigg) \cdot \vec{v}_1
\end{equation}

where
\begin{equation}
c = \sqrt{\cfrac{\gamma p_0}{\rho_0}}
\label{eq:acoustic-speed}
\end{equation}
and
\begin{equation}
\vec{b} = \cfrac{\vec{b}_0}{\sqrt{\rho_0}}.
\label{eq:Alfven-speed}
\end{equation}
We introduce this constants $c$ and $\vec{b}$ as they will be the wave velocities of the solutions of the wave equation \autoref{eq:ideal-wave}. The constant $c$ is the acoustic speed known from regular hydrodynamics. The constant $\vec{b}$ is know as the \textit{Alfvén } velocity and it is a vector in the same direction as the background magnetic field $\vec{B}_0$.\\
\\
Notice that if we set $\vec{B} = 0$ \autoref{eq:ideal-wave} becomes

$$ \frac{\partial^2 \vec{v}_1}{\partial^2 t} = c^2 \nabla^2 \vec{v}_1 $$

which is exactly what we would expect as this is wave equation in the normal hydrodynamic case. This is an important sanity check for our method.\\
\\

We shall be looking for sinusoidal wave solutions. For now we shall also limit the discussion the waves in the velocity vector field as the waves in the scalar pressure and density fields and the magnetic vector field can easily be expressed in terms of the velocity field using the equations \autoref{eq:ideal-MHD-linear}. The solutions we look for are of the form

$$ \vec{v}_1 = \bar{v} \exp(i(\omega t - \vec{k} \cdot \vec{x})) \ .$$ 

Under the constrain of having to provide sinusoidal wave solutions \autoref{eq:ideal-wave} becomes

\begin{equation}
\label{eq:plane-wave-equation}
\bigg( \big( \omega^2 - (\vec{k}\cdot \vec{b})^2 \big) \I - (b^2 + c^2)\vec{k}\vec{k} + \vec{k} \cdot \vec{b}(\vec{k}\vec{b} + \vec{b}\vec{k}) \bigg) \cdot \bar{v} = 0 \ .
\end{equation} 

Without any loss of generality we may assume that $\vec{b} = (b,0,0)$ and $\vec{k} = (k_x, k_y, 0) = (k\cos\theta, k\sin\theta, 0)$ where $\theta$ is the angle between $\vec{b}$ and $\vec{k}$. Filling in these into \autoref{eq:plane-wave-equation} results in

\begin{equation}
\label{eq:plane-wave-equation-matrixform}
\begin{pmatrix}
 \omega^ 2-k_x^2 c^2  &  - k_y k_x c^2  & 0\\
- k_y k_x c^2  &  \omega^2  - k_y^2 (b^2 + c^2) - k_x^2 b^2  &  0\\
0  &  0  & \omega^2  -  k_x^2 b^2
\end{pmatrix}
\begin{pmatrix}
\bar{v}_x \\
\bar{v}_y \\
\bar{v}_z
\end{pmatrix}
 = 
\begin{pmatrix}
0 \\
0 \\
0
\end{pmatrix}
\end{equation} 

In order to solve this we need the determinant of the matrix in \autoref{eq:plane-wave-equation-matrixform} to be $0$. This results in the dispersion relation

\begin{equation}
\label{eq:dispersion}
(\omega^2 - k^2 b^2\cos^2\theta)\left( \omega^4 - \omega^2k^2(b^2+c^2) + b^2 c^2k^4\cos^2\theta  \right) = 0 \ .
\end{equation}


We shall first discuss the factor $\left( \omega^4 - \omega^2k^2(b^2+c^2) + b^2 c^2k^4\cos^2\theta  \right)$
of which the roots are
\begin{equation}
	\omega_{F,S}^2 = \frac{k^2}{2} \left[ b^2+c^2 \pm \sqrt{(b^2+c^2)^2-4b^2c^2\cos^2\theta} \right] 	
	\label{eq:magnetosonic-phase-speed}
\end{equation}
These solutions correspond to the so-calles fast (+) and slow (-) magnetosonic waves. 
Notice that because $(v_a^2+v_s^2)^2-4v_a^2v_s^2\cos^2\theta \geq (v_a^2-v_s^2)^2) \geq 0$ the square root can always be taken.
for the negative sign however

One can readily see that they are the result of a quite complicated interplay between the hydrodynamic and magnetic sides of the story. 
To help us see this better, the other factor will help.\\
\\
The only root of the firs factor in \autoref{eq:dispersion} is $ \omega^2 = k_x^2 b^2 $. This solution is of great interest as it does not contain the same complicated magnetosonic interaction and solely depends on the nature of the magnetic field. The density irregularities only provide the wave's momentum. The restoring force is entirely generated by the tension in the magnetic field.\\
\\
The wave corresponding to $\omega_A^2 = k_x^2 b^2$ is called the \textit{Alfvén} wave. Notice that its direction corresponds to that of the magnetic field, where $\omega_A = k_x b$ lies in the same direction and $-\omega_A$ in the opposite direction. It should be noted that this solution is non-relativistic. As the magnetic field becomes stronger in comparison to the density the Alfén wave becomes a regular electromagnetic wave.\\
\\
Now, the first roots we had - the magnetosonic waves - are combinations of Alvén waves and ordinary sound waves. There are two types because the Alfvén and sound waves can either be in fase or in antifase to one another. In the first case $\omega_F$ the region of high pressure will correspond to a high magnetic field density, which causes the resulting wave to be driven forward by both ordinary hydrodynamic pressure and the tension of the concentrated magnetic field lines. In the other case $\omega_S$ these same two forces work against each other, slowing the wave.


\subsection*{Magnetohydrodynamic shocks}

To derive the Rankine–Hugoniot conditions for MHD shocks, one simply uses \autoref{eq:ideal-MHD} as it is already in its Eulerian form and preforms the same calculations as for the Rankine–Hugoniot conditions for HD shocks. This yields

\begin{equation}
\label{eq:MHD-shock-conditions}
\begin{split}
V_S \Delta \rho &= \vec{n}\cdot\Delta(\rho \ \vec{v})\\
V_S \Delta (\rho \ \vec{v}) &= \vec{n} \cdot \Delta(\rho \ \vec{v} \ \vec{v} + (p + \frac{B^2}{2}) \ \I -  \vec{B}\vec{B}) \\
V_S \Delta E_t &= \vec{n} \cdot \Delta \big( (\rho \frac{v^2}{2} + \frac{\gamma}{\gamma - 1} p + B^2) \ \vec{v} - \vec{v} \cdot \vec{B} \vec{B} \big) \\
V_S \Delta \vec{B} &= \vec{n} \cdot \Delta \big( \vec{v} \vec{B} - \vec{B} \vec{v} \big)
\end{split}
\end{equation}

Now, for the purposes of this report we would like to write a shock condition in terms of pressure as this is the variable on which we shall be focusing in the simulation data results. Consider a pressure discontinuity $\Delta p = p_1 - p_0$ for some constant background density $\rho$. Notice that this implies a shock in the velocity field as well since we get from the ideal gas law that $ v^2 = \frac{\gamma p}{\rho} $.\\
\\
Use the momentum equations to obtain in the 1D case that

\begin{equation}
\label{eq:p-shock-1D}
\begin{split}
V_S = \frac{\Delta \rho v^2 + p}{\Delta \rho v} &=  \frac{\Delta(\gamma +1) p}{\Delta \sqrt{\gamma \rho p}} \\ &=
\frac{(\gamma - 1)(p_1 - p_0)}{\sqrt{\gamma \rho}(\sqrt{p_1} - \sqrt{p_0})} \\ &=
\frac{\gamma-1}{\sqrt{\gamma \rho}} (\sqrt{p_1} + \sqrt{p_0})
\end{split}
\end{equation}

Lifting this to 3D contains a small subtlety. Without loss of generality we may say that the unit normal on the shock front is $\vec{n} = (1,0,0)$. From the 3D momentum equation we then get that 

$$ V_S 
\begin{pmatrix}
\Delta \rho v_1 \\
\Delta \rho v_2 \\
\Delta \rho v_3
\end{pmatrix} 
= 
\begin{pmatrix}
\Delta \rho v^2_1 + p \\
\Delta \rho v_1 v_2 \\
\Delta \rho v_1 v_3
\end{pmatrix} 
$$

Only the first components in this equation are of concern to us since the second and third will be $0$ due to our choice of $\vec{n}$. Now, one think this will yield the same equation as in the 1D case but in should be taken into account that $v_1 \neq v$. In general, we cannot say what the precise relationship between $v_1$ and $\vec{v}$ is but look at the average case $v_1 = \frac{1}{\sqrt{3}} v$. This then gives us the pressure shock condition for 3D

\begin{equation}
\label{eq:p-shock-3D}
V_S = \frac{1}{\sqrt{3}} \frac{\gamma-1}{\sqrt{\gamma \rho}} (\sqrt{p_1} + \sqrt{p_0})
\end{equation}



